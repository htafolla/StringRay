---
name: summary-logger
description: Automated logging of AI-generated summaries and analysis to REFACTORING_LOG.md
---

#!/bin/bash

# StrRay Framework - Summary Logger

# Automatically logs AI-generated summaries and analysis to REFACTORING_LOG.md

# Check for auto-capture mode

if [ "$1" = "--auto-capture" ] || [ -n "$STRRAY_AUTO_CAPTURE" ]; then
echo "ðŸ¤– StrRay Auto-Capture Mode Active"
echo "==================================="
echo "Waiting for 'job done print summary' signal from AI..."
echo "All subsequent output will be captured and logged automatically."
echo ""

    # Create temp file for capture
    TEMP_FILE=$(mktemp)
    CAPTURING=false

    # Monitor for signals (this would be integrated into AI workflow)
    while IFS= read -r line; do
        if [[ "$line" == *"job done print summary"* ]]; then
            CAPTURING=true
            echo "ðŸŽ¯ Signal detected - capturing summary..."
            continue
        fi

        if [ "$CAPTURING" = true ]; then
            echo "$line" >> "$TEMP_FILE"
        fi
    done

    # Log captured content
    if [ -s "$TEMP_FILE" ]; then
        echo "ðŸ“ Logging captured summary..."
        export STRRAY_SUMMARY_CONTENT="$(cat "$TEMP_FILE")"
        tail -n +6 strray/commands/summary-logger.md | bash
        echo "âœ… Auto-logging complete!"
    fi

    rm -f "$TEMP_FILE"
    exit 0

fi

echo "ðŸ“ StrRay Framework - Summary Logger"
echo "===================================="

# Check if summary content is provided via environment variable or stdin

if [ -n "$STRRAY_SUMMARY_CONTENT" ]; then
SUMMARY_CONTENT="$STRRAY_SUMMARY_CONTENT"
elif [ ! -t 0 ]; then
    # Read from stdin
    SUMMARY_CONTENT=$(cat)
elif [ -n "$STRRAY_AUTO_LOG" ]; then # Auto-log mode - wait for job completion signal
echo "ðŸ¤– StrRay Auto-Logger: Waiting for 'job done print summary' signal..."
echo "When you see 'job done print summary', the following summary will be automatically logged."
exit 0
else
echo "âŒ No summary content provided. Use STRRAY_SUMMARY_CONTENT environment variable or pipe content."
echo "Usage:"
echo " export STRRAY_SUMMARY_CONTENT='summary content' && bash strray/commands/summary-logger.md"
echo " echo 'summary content' | bash strray/commands/summary-logger.md"
echo " export STRRAY_AUTO_LOG=1 && bash strray/commands/summary-logger.md # Auto-log mode"
exit 1
fi

# Validate REFACTORING_LOG.md exists

if [ ! -f "logs/agents/refactoring-log.md" ]; then
echo "âŒ logs/agents/refactoring-log.md not found"
exit 1
fi

# Generate timestamp

TIMESTAMP=$(date '+%B %Y')

# Create formatted log entry

LOG_ENTRY="

## ðŸ¤– AI Analysis Summary - $TIMESTAMP

**Generated by**: StrRay Framework AI Agent
**Analysis Type**: Automated Development Intelligence
**Timestamp**: $(date '+%Y-%m-%d %H:%M:%S')

### Summary Content

$SUMMARY_CONTENT

---

_This entry was automatically logged by the StrRay Framework summary logging system._
"

# Append to REFACTORING_LOG.md

echo "$LOG_ENTRY" >> logs/agents/refactoring-log.md

echo "âœ… Summary successfully logged to logs/agents/refactoring-log.md"
echo "ðŸ“Š Entry added with timestamp: $(date '+%Y-%m-%d %H:%M:%S')"
